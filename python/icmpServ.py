#!/usr/bin/python

#Name: Riley Scott
#Date: 2018-02-11
#Version: 1.1
#Description: ICMP server script

import sys
from scapy.all import *

conf.verb = 0

f = open(sys.argv[1],"w")
host = sys.argv[2]
count = int(sys.argv[3])

criteria = "icmp and host " + host
print "sniffing with filter (%s) for %d bytes" % (criteria,int(count))

packets = sniff(count,filter=criteria)
for p in packets:
    f.write(p['Raw'].load)
    print "."

f.close()
print "Data received"
