#!/usr/bin/ruby

#Name: Riley Scott
#Date: 2017-11-14
#Version: 1.0
#Description: Finds users that have logged into a system

#execute last command and split at line
data = `last`.split("\n")

#create arrays users and hosts
users = []
hosts = []

#for each data entry, check if line is reboot or wtmp, if not strip line and enter data into proper arrays
data.each do |l|
  if l == ""
    next
  elsif l.start_with? "reboot"
    next
  elsif l.start_with? "wtmp"
    next
  else
    l.rstrip!
    users << l[0,8].rstrip
    hosts << l[17,16].rstrip.lstrip
  end
end

#make sure each entry is unique, deletes repeat entries
users.uniq!
hosts.uniq!

#outputs users
until users.empty?
  print "User: %s\n" % users.pop
end

#outputs hosts, seems to all be in IPv6
while not hosts.empty?
  print "Host: %s\n" % hosts.pop
end
