#!/usr/bin/ruby

#Name: Riley Scott
#Date: 2017-11-14
#Version: 1.1
#Description: Generates an ARP table

require 'socket'

s = UDPSocket.new

254.times do |i|
  next if i == 0
  s.send("test", 0, "172.16.3." + i.to_s, 53)
end

f = File.open("/proc/net/arp",'r')
data = f.read.split("\n")

up_hosts = []
data.each do |line|
  entry = line.split(/\s+/)
  next if entry[3] == "00:00:00:00:00:00"
  next if entry[0] == "IP"
  up_hosts << { :ip => entry[0], :mac => entry[3]}
end

print "active network hosts\n"
print "%-12s\t%s\n" % ["IP Address" , "Mac Address"]
up_hosts.each do |host|
  print "%-12s\t%s\n" % [host[:ip], host[:mac]]
end
